<input type="file" id="f">
<button id="b">Upload</button>
<script src="config.js"></script> <!-- must define global scriptURL -->
<script>
const b = document.getElementById("b");
const f = document.getElementById("f");

b.addEventListener("click", async () => {
  if (!f.files.length) {
    console.warn("No file selected");
    return;
  }

  const file = f.files[0];
  const fd = new FormData();
  fd.append("uploadedFile", file);
  fd.append("system", "clientUploads");
  fd.append("action", "saveUploadedFiles");

  console.log("📤 Uploading file…", file.name);
  try {
    const res = await fetch(scriptURL, { method: "POST", body: fd });
    const text = await res.text();
    console.log("📡 Server raw response:", text);

    let result;
    try {
      result = JSON.parse(text);
    } catch (err) {
      console.error("❌ Server returned invalid JSON:", err.message);
      return;
    }

    if (result.success) {
      console.log(`✅ File uploaded successfully: ${file.name}`, result);
    } else {
      console.error(`❌ Upload failed: ${file.name}`, result);
    }
  } catch (err) {
    console.error("❌ Upload error:", err);
  }
});
</script>
