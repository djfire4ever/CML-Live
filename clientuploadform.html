<input type="file" id="fileInput">
<textarea id="noteInput" placeholder="Add a note (optional)"></textarea>
<button id="uploadBtn">Upload</button>
<div id="status"></div>

<script>
const uploadBtn = document.getElementById("uploadBtn");
const fileInput = document.getElementById("fileInput");
const noteInput = document.getElementById("noteInput");
const statusDiv = document.getElementById("status");

uploadBtn.addEventListener("click", async () => {
  if (!fileInput.files.length) return console.warn("No file selected");

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = async (e) => {
    const base64Data = e.target.result.split(",")[1]; // remove prefix
    const payload = {
      system: "clientUploads",
      action: "saveUploadedFiles",
      clientID: window.clientID || "",   // from your config.js / page
      firstName: window.firstName || "", // from your config.js / page
      fileNote: noteInput.value,
      fileName: file.name,
      fileType: file.type,
      fileBase64: base64Data
    };

    try {
      statusDiv.textContent = `üì§ Uploading file‚Ä¶ ${file.name}`;
      const res = await fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const result = await res.json();
      if (result.success) {
        statusDiv.textContent = `‚úÖ File uploaded successfully: ${file.name}`;
        console.log(result);
      } else {
        statusDiv.textContent = `‚ùå Upload failed: ${result.message}`;
        console.error(result);
      }
    } catch (err) {
      statusDiv.textContent = `‚ùå Upload error: ${err.message}`;
      console.error(err);
    }
  };

  reader.readAsDataURL(file);
});
</script>
