<input type="file" id="fileInput">
<textarea id="noteInput" placeholder="Add a note (optional)"></textarea>
<button id="uploadBtn">Upload</button>
<div id="status"></div>

<script src="config.js"></script>

<script>
const uploadBtn = document.getElementById("uploadBtn");
const fileInput = document.getElementById("fileInput");
const noteInput = document.getElementById("noteInput");

uploadBtn.addEventListener("click", () => {
  const file = fileInput.files[0];
  if (!file) return console.error("No file selected");

  const reader = new FileReader();
  reader.onload = async (e) => {
    const base64 = e.target.result.split(",")[1]; // get only the Base64 part

    const payload = {
      system: "clientUploads",
      action: "saveUploadedFiles",
      clientID: "3863079249",
      firstName: "Felix",
      fileName: file.name,
      fileType: file.type || "application/octet-stream",
      fileBase64: base64,
      fileNote: noteInput.value || ""
    };

    try {
      const res = await fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(payload),
        headers: { "Content-Type": "application/json" }
      });

      const data = await res.json();
      if (data.success) {
        console.log("✅ Upload successful!", data);
      } else {
        console.error("❌ Upload failed:", data);
      }
    } catch (err) {
      console.error("Upload error:", err);
    }
  };
  
  reader.readAsDataURL(file); // triggers onload with Base64
});
</script>