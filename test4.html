<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Demo Storefront</title>
  <style>
    .cart-sidebar {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100%;
      background: #fff;
      border-left: 1px solid #ddd;
      box-shadow: -2px 0 5px rgba(0,0,0,0.2);
      transition: right 0.3s ease-in-out;
      z-index: 1050;
      overflow-y: auto;
      padding: 1rem;
    }
    .cart-sidebar.open {
      right: 0;
    }
  </style>
</head>
<body class="bg-light">

  <!-- Header -->
  <nav class="navbar navbar-light bg-white shadow-sm">
    <div class="container">
      <span class="navbar-brand">My Store</span>
      <button id="cartToggleBtn" class="btn btn-outline-primary">
        Cart (<span id="cartCount">0</span>)
      </button>
    </div>
  </nav>

  <!-- Product Grid -->
  <div class="container my-4">
    <div class="row" id="productGrid">
      <!-- JS will render products here -->
    </div>
  </div>

  <!-- Cart Sidebar -->
  <div id="cartSidebar" class="cart-sidebar">
    <h5>Your Cart</h5>
    <ul id="cartItems" class="list-group mb-3"></ul>
    <p class="fw-bold">Total: <span id="cartTotal">$0.00</span></p>
    <button class="btn btn-success w-100">Checkout</button>
  </div>

  <script src="config.js"></script>
  <script>
    // Example "products" (would come from Product Manager)
    const products = [
      { id: 1, name: "Product A", price: 19.99 },
      { id: 2, name: "Product B", price: 29.99 },
      { id: 3, name: "Product C", price: 49.99 },
    ];

    const productGrid = document.getElementById("productGrid");
    const cartSidebar = document.getElementById("cartSidebar");
    const cartToggleBtn = document.getElementById("cartToggleBtn");
    const cartItems = document.getElementById("cartItems");
    const cartTotal = document.getElementById("cartTotal");
    const cartCount = document.getElementById("cartCount");

    let cart = [];

    // Render products
    products.forEach(p => {
      const col = document.createElement("div");
      col.className = "col-md-4";
      col.innerHTML = `
        <div class="card shadow-sm mb-3">
          <div class="card-body">
            <h5 class="card-title">${p.name}</h5>
            <p class="card-text">$${p.price.toFixed(2)}</p>
            <button class="btn btn-primary w-100 add-to-cart" data-id="${p.id}">Add to Cart</button>
          </div>
        </div>
      `;
      productGrid.appendChild(col);
    });

    // Toggle cart sidebar
    cartToggleBtn.addEventListener("click", () => {
      cartSidebar.classList.toggle("open");
    });

    // Add to cart logic
    document.querySelectorAll(".add-to-cart").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = parseInt(btn.dataset.id);
        const product = products.find(p => p.id === id);
        const existing = cart.find(item => item.id === id);

        if (existing) {
          existing.qty += 1;
        } else {
          cart.push({ ...product, qty: 1 });
        }

        renderCart();
      });
    });

    // Render cart items
    function renderCart() {
      cartItems.innerHTML = "";
      let total = 0;

      cart.forEach(item => {
        total += item.price * item.qty;
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          ${item.name} x ${item.qty}
          <span>$${(item.price * item.qty).toFixed(2)}</span>
        `;
        cartItems.appendChild(li);
      });

      cartTotal.textContent = `$${total.toFixed(2)}`;
      cartCount.textContent = cart.reduce((sum, i) => sum + i.qty, 0);
    }
  </script>

</body>
</html>
