<style>
  /* === Base Invoice Styles === */
  @page {
    margin: 0; /* remove default print margins */
  }

  body {
    margin: 0;
    padding: 0;
  }

  /* === Invoice container === */
  .invoice-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 7.5in;      /* debug width */
    height: 10in;      /* debug height */
    border: 2px dashed red; /* debug visualization */
    box-sizing: border-box;
    background-color: white;
  }

  .invoice-table {
    border-collapse: collapse;
    table-layout: fixed;
    width: 100%; /* fill container */
    font-family: Arial, sans-serif;
    font-size: 10pt;
  }

  .invoice-table td {
    padding: 2px 3px;
    vertical-align: bottom;
    overflow: hidden;
    text-overflow: ellipsis;
    /* border: 1px solid rgba(0, 0, 0, 0.3); */
  }

  .invoice-table .header-row td {
    font-weight: bold;
    border-bottom: 1px solid #999;
    padding-top: 6px;
  }

  .invoice-table .text-right {
    text-align: right;
  }

  .invoice-table .nowrap {
    white-space: nowrap;
  }

  .invoice-table .terms {
    padding-top: 10px;
    line-height: 1.4;
    font-size: 9pt;
  }

  .invoice-table .totals-section td {
    border-top: 1px solid #999;
    padding-top: 6px;
  }
</style>

<div class="invoice-page">
  <table class="invoice-table">
    <colgroup>
      <col style="width: 150px;">
      <col style="width: 120px;">
      <col style="width: 120px;">
      <col style="width: 75px;">
      <col style="width: 120px;">
      <col style="width: 120px;">
    </colgroup>
    <tbody id="invoice-body">
      <!-- Header -->
      <tr><td colspan="6" style="background-color: green; height: 24px;">&nbsp;</td></tr>
      <tr><td colspan="6" style="font-weight: bold; font-size: 18pt; color: green;">CraftyMama Labs</td></tr>
      <tr><td colspan="6" style="font-weight: bold; font-size: 12pt; color: greenyellow;">CUSTOM EVENT DECOR CREATOR</td></tr>
      <tr><td colspan="6" style="font-weight: bold;">(332) 202-8819</td></tr>
      <tr><td colspan="6" style="font-weight: bold;">tiffany@craftymamalabs.com</td></tr>
      <tr><td colspan="6" style="font-weight: bold; font-size: 14pt; color: green;"><strong>Invoice</strong></td></tr>

      <!-- Client + Invoice Info -->
      <tr>
        <td style="font-weight: bold;">Bill To:</td><td></td>
        <td style="font-weight: bold;">Invoice #</td><td></td>
        <td style="font-weight: bold;">Invoice Date</td><td></td>
      </tr>
      <tr>
        <td>&lt;&lt;firstName&gt;&gt;</td>
        <td>&lt;&lt;lastName&gt;&gt;</td>
        <td>&lt;&lt;invoiceID&gt;&gt;</td>
        <td></td>
        <td class="nowrap">&lt;&lt;invoiceDate&gt;&gt;</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="6">&lt;&lt;street&gt;&gt;</td>
      </tr>
      <tr>
        <td>&lt;&lt;city&gt;&gt;</td>
        <td>&lt;&lt;state&gt;&gt;</td>
        <td>&lt;&lt;zip&gt;&gt;</td>
        <td></td><td></td><td></td>
      </tr>
      <tr>
        <td style="font-weight: bold;">&lt;&lt;clientID&gt;&gt;</td>
        <td></td>
        <td style="font-weight: bold;">Event Date</td>
        <td></td>
        <td style="font-weight: bold;">Event Location</td>
        <td></td>
      </tr>
      <tr>
        <td colspan="2">&lt;&lt;email&gt;&gt;</td>
        <td class="nowrap">&lt;&lt;eventDate&gt;&gt;</td>
        <td></td>
        <td colspan="2">&lt;&lt;eventLocation&gt;&gt;</td>
      </tr>

      <tr class="header-row" id="parts-header">
        <td colspan="3" style="font-weight: bold;">Description</td>
        <td style="font-weight: bold; text-align: center;">Qty</td>
        <td style="font-weight: bold; text-align: right;">Unit Price</td>
        <td style="font-weight: bold; text-align: right;">Total Price</td>
      </tr>
    </tbody>

    <!-- Totals Section -->
    <tbody id="totals-section">
      <tr class="totals-section">
        <td></td>
        <td></td>
        <td></td><td></td>
        <td style="font-weight: bold; text-align: right;">Subtotal</td>
         <td style="font-weight: bold; text-align: right;">&lt;&lt;totalProductRetail&gt;&gt;</td>
      </tr>
      <tr>
        <td style="font-weight: bold;">Tax</td><td>8.875%</td><td></td><td></td>
        <td style="text-align: right; ">&lt;&lt;subTotal1&gt;&gt;</td><td style="text-align: right;">&lt;&lt;subTotal2&gt;&gt;</td>
      </tr>
      <tr>
        <td style="font-weight: bold;">Discount</td><td></td><td></td>
        <td style="text-align: right;">&lt;&lt;discount&gt;&gt;</td><td style="text-align: right;">&lt;&lt;subTotal3&gt;&gt;</td><td style="text-align: right;">&lt;&lt;discountedTotal&gt;&gt;</td>
      </tr>
      <tr>
        <td style="font-weight: bold;">Add-Ons</td><td></td><td></td><td></td>
        <td style="text-align: right;">&lt;&lt;addonsTotals&gt;&gt;</td><td style="text-align: right;">&lt;&lt;grandTotal&gt;&gt;</td>
      </tr>
      <tr>
        <td style="font-weight: bold;">Deposit*</td><td></td>
        <td>&lt;&lt;deposit&gt;&gt;</td>
        <td style="font-weight: bold;">Paid on</td>
        <td class="nowrap">&lt;&lt;depositDate&gt;&gt;</td>
        <td></td>
      </tr>
      <tr>
        <td style="font-weight: bold;">Balance of</td><td></td>
        <td>&lt;&lt;balanceDue&gt;&gt;</td>
        <td style="font-weight: bold;">Due By</td>
        <td class="nowrap">&lt;&lt;balanceDueDate&gt;&gt;</td>
        <td>&lt;&lt;paymentMethod&gt;&gt;</td>
      </tr>
      <tr>
        <td colspan="6" class="terms">
          <strong>Terms:</strong> As per agreed Terms and Conditions<br>
          *Payment is due within 30 days of the invoice date. Late payments may be subject to a 5% late fee.<br>
          *Deposits are due upon receipt of this invoice and are non-refundable.<br>
          *Deposit does not include Add-Ons. Add-Ons are due upon final payment.
        </td>
      </tr>
    </tbody>
  </table>
</div>

<script>
  const fakeData = {
    firstName: "Tiffany",
    lastName: "Anderson",
    invoiceID: "25",
    invoiceDate: "11/22/2025",
    street: "1234 Long Street Name Avenue",
    city: "Brooklyn",
    state: "NY",
    zip: "11206",
    clientID: "(212) 555-7890",
    email: "tiffany@craftymamalabs.com",
    eventDate: "12/15/2025",
    eventLocation: "Grand Metropolitan Ballroom",
    totalProductRetail: "$1,245.00",
    subTotal1: "$110.49",
    subTotal2: "$1,355.49",
    discount: "10%",
    subTotal3: "$1,220.00",
    discountedTotal: "$1,220.00",
    addonsTotals: "$150.00",
    grandTotal: "$1,370.00",
    deposit: "$500.00",
    depositDate: "11/10/2025",
    balanceDue: "$870.00",
    balanceDueDate: "12/20/2025",
    paymentMethod: "Credit Card"
  };

  // Replace placeholders with fake data
  document.querySelectorAll(".invoice-table td").forEach(td => {
    td.innerHTML = td.innerHTML.replace(/&lt;&lt;(\w+)&gt;&gt;/g, (match, key) => {
      return fakeData[key] || match;
    });
  });

  // Insert parts directly after the header
  const headerRow = document.getElementById("parts-header");

  for (let i = 1; i <= 15; i++) {
    const partName = `Custom Floral Arrangement Custom Floral Even Longer  ${i}`;
    const qty = Math.floor(Math.random() * 5) + 1;
    const unitPrice = (Math.random() * 120 + 25).toFixed(2);
    const totalPrice = (qty * unitPrice).toFixed(2);

    const row = document.createElement("tr");
    row.innerHTML = `
      <td colspan="3">${partName}</td>
      <td style="text-align: center;">${qty}</td>
      <td style="text-align: right;">$${unitPrice}</td>
      <td style="text-align: right;">$${totalPrice}</td>
    `;
    headerRow.parentNode.insertBefore(row, headerRow.nextSibling);
  }
</script>
